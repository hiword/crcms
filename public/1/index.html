<!DOCTYPE html>
<html ng-app="app">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap.min.css">
<link rel="stylesheet" href="static/css/basic.css" />
<!-- 可选的Bootstrap主题文件（一般不用引入） -->
<link rel="stylesheet" href="//cdn.bootcss.com/bootstrap/3.3.5/css/bootstrap-theme.min.css">
<link rel="stylesheet" href="vendor/font-awesome/4.5.0/css/font-awesome.min.css" />
<title>Insert title here</title>
</head>
<body>
<div class="main-left pull-left">
	<div class="left-top">
		<h1 class="logo"><a href="###">CRCMS</a></h1>
		<div class="meta meta-1">致力于打造全面化的开源CMS系统</div>
		<div class="meta meta-2">记录我的生活，我的经验和笔记</div>
		<div class="meta meta-3"></div>
	</div>
	<div class="left-bottom">
		<p>
			<a href="###"><i class="fa fa-qq fa-lg"></i></a>
			<a href="###" class="ml10"><i class="fa fa-github fa-lg"></i></a>
			<a href="###" class="ml10"><i class="fa fa-envelope fa-lg"></i></a>
		</p>
		<p>
			Copyright <!-- © --><i class="fa fa-copyright"></i> 2013-2014
		</p>
	</div>
</div>
<div class="main-right pull-right">
	<div class="articles" ng-controller="listController">
		<article ng-repeat="list in lists">
			<a class="title" href="###">{{list.title}}</a>
			<div class="content"> 
				1.梁实秋说：你走，我不送你。你来，无论多大风多大雨，我要去接你。 2.海明威说：优于别人，并不高贵，真正的高贵应该是优于过去的自己。 3.三毛说：如果有来生，要做一棵树，站成永恒，没有悲伤的姿势：一半在尘土里安详，一半在空中飞扬；一半散落阴凉，一半沐浴阳光。非常沉默非常骄傲，从不依靠从不寻找。 4.顾漫...
			</div>
			<div class="article-info mt10 mb10">
				<span>
					<i class="glyphicon glyphicon-calendar"></i>
					({{ list.created_at * 1000 | date:'yyyy-MM-dd' }})
				</span>
				<span>
					<i class="glyphicon glyphicon-tag"></i>
					<a rel="category tag" href="http://haikun.me/category/%e6%96%87%e7%ab%a0">文章</a>
				</span>
				<span>
					<i class="glyphicon glyphicon-comment"></i>
					<span class="ds-thread-count" data-replace="1" data-thread-key="2171">2</span>
				</span>
			</div>
		</article>
		<div class="page">
			{{$page}}
		</div>
	</div>
</div>
<!-- jQuery文件。务必在bootstrap.min.js 之前引入 -->
<script src="//cdn.bootcss.com/jquery/1.11.3/jquery.min.js"></script>
<!-- 最新的 Bootstrap 核心 JavaScript 文件 -->
<script src="//cdn.bootcss.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="../vendor/angularjs/1.4.8/angular.min.js"></script>
<script>
	var app = angular.module('app',[]);
	//factory 使用于功能简单，类似于单例的一样，service适用于逻辑处理比较复杂的方法
	app.factory('documentListFactory',['$http','$q',function($http,$q){
		//申明一个延迟
		var deferred = $q.defer();
		$http.get('http://3.cs/index.php?_json=1&_content=1').success(function(response){
			deferred.resolve(response);
		}).error(function(response){
			deferred.reject(response);
		});
		// 返回承诺，这里并不是最终数据，而是访问最终数据的API 
		return deferred.promise;   
	}]);
	
	app.factory('documentTagsFactory',['$http','$q',function($http,$q){
		//申明一个延迟
		return {
			query(ids)
			{
				var deferred = $q.defer();
				$http.post('http://3.cs/index.php/tags/assoc-tags',{
					'id':ids,
					'model':'Document'
				}).success(function(response){
					deferred.resolve(response);
				}).error(function(response){
					deferred.reject(response);
				});
				return deferred.promise;
			}
		}
	}]);
	
	app.controller('listController',['$scope','$http','documentListFactory',function($scope,$http,documentListFactory){
		//var promise = documentListFactory;
		//then方法// 调用承诺API获取数据
		var documentList = {};
		documentListFactory.then(function(data){
			documentList = data.data.models;
			console.log(documentList);
		});
		
		
		/* $http.get('http://3.cs/index.php?_json=1&_content=1').success(function(response){
			$scope.lists = response.data.models;
			$scope.page = response.data.page;
		});
		console.log($scope);
		console.log($http); */
	}]);
	
	$(function(){
		/* $.get('http://3.cs/index.php?_json=1&_content=1',function(data){
			console.log(data);
		}) */
	})
</script>
</body>
</html>